{
  "hash": "eb3936e84b170213691446d4e219ff47",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Figure 1 Replication\"\n---\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: setup\n\n# set seed for reproducibility\nset.seed(12345)\n\n# load packages (those commented out may or may not be necessary)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: setup\n\nlibrary(naniar) # data structures, summaries, and visuals for missing data\nlibrary(srvyr) # 'dplyr'-Like Syntax for summary statistics of survey data\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'srvyr'\n\nThe following object is masked from 'package:stats':\n\n    filter\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: setup\n\n# load cdf as tbl_svy object (i.e., with weight variable applied)\ncdf_wt <- readr::read_rds(here::here(\"data\", \"anes_cdf_wts_tbl_svy.rds\"))\n```\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis notebook replicates Figure 1 from @chamberlain2012. Constructing this figure requires the ANES Time Series Cumulative Data file.\n\nFirst, I convert the two variables of interest into factors, where response codes are converted to the text of the response option categories. Each level of the factor variables corresponds to one of the response option categories and is prefixed with the corresponding response value label (e.g., [1] Agree, [2] Disagree).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# convert `nocare` and `nosay` to factor vars\ncdf_wt <- cdf_wt |>\n  srvyr::mutate(across(c(nocare, nosay), ~ sjlabelled::set_labels(\n    .x, labels = c(\n      \"Agree\" = 1,\n      \"Disagree\" = 2,\n      \"Neither\" = 3,\n      \"DK\" = 9\n    )\n  ))) |>\n  srvyr::mutate(across(c(nocare, nosay), ~ sjlabelled::as_label(., prefix = TRUE)))\n```\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCreate a function that returns a table of proportions of for each factor level conditioned on a grouping variable for a single categorical variable (i.e., survey question item). This function is useful in particular for `tbl_svy` objects and relies on the `srvyr` R package. This function is a slightly modified version of a similar one found [here](https://tidy-survey-r.github.io/tidy-survey-book/c05-descriptive-analysis.html#example-3-purrrmap).\n\nIn other words, I create a function that will return the proportion of responses by year, and since I have applied the appropriate weights provided in the ANES cumulative data file using the `srvyr` R package, the function also returns the standard error for each estimate.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# create function that returns a table of response proportions for a single\n# variable (factor) by grouping variable, i.e., proportions of `var` conditional\n# to `group_var`\n# this function is a modified version of the one from the following url\n# (https://tidy-survey-r.github.io/tidy-survey-book/c05-descriptive-analysis.html#example-3-purrrmap)\n\ncalcps <- function(dat, var, group_var) {\n  { dat } |>  \n    srvyr::drop_na(!!sym(var)) |> \n    srvyr::group_by(!!sym(group_var), !!sym(var)) |> \n    srvyr::summarize(prop = srvyr::survey_prop() * 100) |> \n    srvyr::mutate(Variable = stringr::str_to_upper(var)) |> \n    srvyr::rename(Response := !!sym(var)) |> \n    srvyr::select(!!sym(group_var), Variable, everything())\n}\n```\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nI create two tables of proportions for both the `NOCARE` and `NOSAY` external political efficacy items conditioned on the year of the ANES. Then, I bind the rows of the two tables together, which basically stacks one table atop the other, and assign this as a named object `resp_tab_by_year`. This combined table organizes the date into long format, where each row is a response to the particular question item by year. Organizing the data into long format allows me to replicate proportion of particular responses across the years. \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# this returns a table of response proportions for a single variable (factor)\n# using this table, I am able to get the proportion of \"Agree\", \"Disagree\" etc.\n# for the `NOCARE` and `NOSAY` variables by year.\n\n# create two tables for NOSAY and NOCARE variables\nnocare_by_yr <- calcps(cdf_wt, var = \"nocare\", group_var = \"year\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWhen `proportion` is unspecified, `survey_prop()` now defaults to `proportion = TRUE`.\nℹ This should improve confidence interval coverage.\nThis message is displayed once per session.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nnosay_by_yr <- calcps(cdf_wt, var = \"nosay\", group_var = \"year\")\n\n\n# bind rows of tables (basically stack one on top of the other)\nresp_tab_by_year <- nosay_by_yr |> \n  dplyr::bind_rows(nocare_by_yr) |> \n  dplyr::arrange(year)\n```\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTo replicate Figure 1, I filter to \"Disagree\" responses and plot lines representing the proportion of those who \"Disagree\" to each question across time as a percentage. Also, the data in the replicated figure is limited to the data available to Chamberlain at the time\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n::: {#cell-fig-rep1 .cell .fig-cap-location-bottom}\n\n```{.r .cell-code .hidden}\n#| label: fig-rep1\n#| fig-cap: \"Replication of Figure 1 in @chamberlain2012---Percent of Respondents Who Feel Efficacious for Each Question. Survey respondents are asked whether they agree or disagree with the following statements: 'Public officials don't care much what people like me think' and 'People like me don't have any say about what the government does.'. Disagreement reflects feelings of external political efficacy. Source data: ANES Time Series Cumulative Data File.\"\n#| fig-cap-location: bottom\n\n# replicate plot \n# Figure 1. Percent of Respondents Who Feel Efficacious for Each Question NOTE:\n# This doesn't expand the y-axis to range from 0-100, which mirrors Figure 1 in\n# Chamberlain (2012). Also limit the data to what was available to Chamberlain\n# at the time\nresp_tab_by_year |>\n  dplyr::filter(Response == \"[2] Disagree\", year <= 2008) |> \n  ggplot2::ggplot(aes(x = year, y = prop, linetype = Variable))+\n  ggplot2::geom_line()+\n  ggplot2::scale_linetype_manual(\n    values = c(\"NOSAY\" = \"solid\", \"NOCARE\" = \"dashed\"), \n    labels = c(\"NOSAY\" = \"No Say\", \"NOCARE\" = \"Don't Care\"))+\n  ggplot2::scale_x_continuous(\n    limits = c(1950, 2010),\n    breaks = seq(1950, 2010, by = 10),\n    expan = ggplot2::expansion(0.01,0.01))+\n  ggplot2::scale_y_continuous(n.breaks = 6)+\n  ggplot2::labs(\n    caption = stringr::str_wrap(\"Source data: ANES Time Series Cumulative Data File\"),\n    x = \"Year\",\n    y = \"Percent\")+\n  ggplot2::theme_bw()+\n  ggplot2::theme(\n    legend.position = \"bottom\",\n    legend.title = element_blank(),\n    panel.background = element_blank(),\n    panel.grid = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![Replication of Figure 1 in @chamberlain2012---Percent of Respondents Who Feel Efficacious for Each Question. Survey respondents are asked whether they agree or disagree with the following statements: 'Public officials don't care much what people like me think' and 'People like me don't have any say about what the government does.'. Disagreement reflects feelings of external political efficacy. Source data: ANES Time Series Cumulative Data File.](figure1_replication_files/figure-html/fig-rep1-1.png){#fig-rep1 width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIn the original article, the Y-axis of @fig-rep1 was not scaled to range from 0 to 100. Note also that the `NOSAY` external efficacy question was not asked in the 1986 ANES; A line for responses to the `NOSAY` question between 1984 and 1988 is drawn implicitly via linear interpolation. It is possible to highlight the year where `NOSAY` was not asked by including layer of point values via `geom_miss_point` from the `naniar` R package.\n\nI extend the time-series chart to include the years of ANES data made available since Chamberlain's original study^[At the time of writing, preliminary data for ANES 2024 was available but not yet included in the Cumulative Data File.] \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n::: {#cell-fig-rep1adj .cell .fig-cap-location-bottom}\n\n```{.r .cell-code .hidden}\n#| label: fig-rep1adj\n#| fig-cap: \"Extended Replication of Figure 1 in @chamberlain2012---Percent of Respondents  Who Disagree with Either Question Statement. Survey respondents are asked whether they agree or disagree with the following statements: 'Public officials don't care much what people like me think' and 'People like me don't have any say about what the government does.'. Disagreement reflects feelings of external efficacy. Source data: ANES Time Series Cumulative Data File. Note that the `NOSAY` question was not included in the 1986 ANES\"\n#| fig-cap-location: bottom\n\n# Now same plot, but this time the y-axis is scaled to range from 0-100 and\n# point values for each response proportion value is added to each line for\n# better comparison. A single point highlights the year `NOSAY` was not asked.\n# Data from subsequent ANES surveys since 2008 is also included\nresp_tab_by_year |> \n  # temporarily ungroup dataframe; can't add row to grouped dataframe\n  dplyr::ungroup() |> \n  # add single row of missing data (omitted columns are NA by default)\n  tibble::add_row(tibble::tibble_row(\n    year = 1986, Variable = \"NOSAY\", Response = \"[2] Disagree\"), .after = 87) |>\n  # re-group by year\n  dplyr::group_by(year) |>\n  # include only \"Disagree\" responses\n  dplyr::filter(Response == \"[2] Disagree\") |>\n  # create plot\n  ggplot2::ggplot(aes(x = year, y = prop, linetype = Variable))+\n  ggplot2::geom_line()+\n  # add point values including points for missing values. \n  # prop_below: place 75% above min point value\n  naniar::geom_miss_point(prop_below = -0.75)+\n  # ggplot2::geom_point()+\n  ggplot2::scale_linetype_manual(\n    values = c(\"NOSAY\" = \"solid\", \"NOCARE\" = \"dashed\"), \n    labels = c(\"NOSAY\" = \"No Say\", \"NOCARE\" = \"Don't Care\"))+\n  ggplot2::scale_colour_manual(\n    values = c(\"Missing\" = \"red\"),\n    labels = c(\"Missing\" = \"Not Asked\", \"Not Missing\" = \"Asked\")\n  )+\n  ggplot2::scale_x_continuous(\n    limits = c(1950, 2020),\n    breaks = seq(1952, 2020, by = 4),\n    expan = ggplot2::expansion(0.01,0.01))+\n  ggplot2::scale_y_continuous(\n    limits = c(0,100),\n    # expansion gets rid of padding\n    expand = ggplot2::expansion(0,0))+\n  ggplot2::labs(\n    caption = stringr::str_wrap(\"Source data: ANES Time Series Cumulative Data File\"),\n    x = \"Year\",\n    y = \"Percent\")+\n  ggplot2::theme_bw()+\n  ggplot2::theme(\n    legend.position = \"bottom\",\n    legend.title = element_blank(),\n    panel.background = element_blank(),\n    panel.grid = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![Extended Replication of Figure 1 in @chamberlain2012---Percent of Respondents  Who Disagree with Either Question Statement. Survey respondents are asked whether they agree or disagree with the following statements: 'Public officials don't care much what people like me think' and 'People like me don't have any say about what the government does.'. Disagreement reflects feelings of external efficacy. Source data: ANES Time Series Cumulative Data File. Note that the `NOSAY` question was not included in the 1986 ANES](figure1_replication_files/figure-html/fig-rep1adj-1.png){#fig-rep1adj width=672}\n:::\n:::\n",
    "supporting": [
      "figure1_replication_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}